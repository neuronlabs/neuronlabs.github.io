<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  
    <title>Scope - neuronlabs.github.io</title>

    
  

  <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" type="image/x-icon">

  <link rel="stylesheet" href="http://localhost:4000/assets/css/just-the-docs.css">

  

  
  <script type="text/javascript" src="http://localhost:4000/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Scope | neuronlabs.github.io</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Scope" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Neuronlabs Pages repository" />
<meta property="og:description" content="Neuronlabs Pages repository" />
<link rel="canonical" href="http://localhost:4000/neuron-core/query/scope.html" />
<meta property="og:url" content="http://localhost:4000/neuron-core/query/scope.html" />
<meta property="og:site_name" content="neuronlabs.github.io" />
<script type="application/ld+json">
{"@type":"WebPage","headline":"Scope","url":"http://localhost:4000/neuron-core/query/scope.html","description":"Neuronlabs Pages repository","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>

  <div class="page-wrap">
    <div class="side-bar">
      <a href="http://localhost:4000" class="site-title fs-6 lh-tight">neuronlabs.github.io</a>
      <span class="fs-3"><button class="js-main-nav-trigger navigation-list-toggle btn btn-outline" type="button" data-text-toggle="Hide">Menu</button></span>
      <div class="navigation main-nav js-main-nav">
        <nav role="navigation" aria-label="Main navigation">
  <ul class="navigation-list">
    
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="http://localhost:4000/" class="navigation-list-link">Neuron</a>
            
          </li>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item active">
            
            <a href="http://localhost:4000/neuron-core" class="navigation-list-link">Core ORM</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/neuron-core/controller.html" class="navigation-list-link">Controller</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/neuron-core/repositories.html" class="navigation-list-link">Repositories</a>
                      
                    </li>
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/neuron-core/models" class="navigation-list-link">Models</a>
                      
                        
                        <ul class="navigation-list-child-list">
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/neuron-core/models/structure.html" class="navigation-list-link">Structure</a>
                              </li>
                            
                          
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/neuron-core/models/field.html" class="navigation-list-link">Fields</a>
                              </li>
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/neuron-core/models/relationship.html" class="navigation-list-link">Relationships</a>
                              </li>
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/neuron-core/models/config.html" class="navigation-list-link">Config</a>
                              </li>
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                        </ul>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item  active">
                      
                      <a href="http://localhost:4000/neuron-core/query/" class="navigation-list-link">Query</a>
                      
                        
                        <ul class="navigation-list-child-list">
                          
                            
                          
                            
                          
                            
                          
                            
                              <li class="navigation-list-item  active">
                                <a href="http://localhost:4000/neuron-core/query/scope.html" class="navigation-list-link active">Scope</a>
                              </li>
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/neuron-core/query/insert.html" class="navigation-list-link">Insert</a>
                              </li>
                            
                          
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/neuron-core/query/get.html" class="navigation-list-link">Get</a>
                              </li>
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/neuron-core/query/list.html" class="navigation-list-link">List</a>
                              </li>
                            
                          
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/neuron-core/query/patch.html" class="navigation-list-link">Patch</a>
                              </li>
                            
                          
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/neuron-core/query/delete.html" class="navigation-list-link">Delete</a>
                              </li>
                            
                          
                            
                          
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/neuron-core/query/filters.html" class="navigation-list-link">Filters</a>
                              </li>
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/neuron-core/query/fieldset.html" class="navigation-list-link">Fieldset</a>
                              </li>
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/neuron-core/query/selected_fields.html" class="navigation-list-link">Selected Fields</a>
                              </li>
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/neuron-core/query/sorts.html" class="navigation-list-link">Sorts</a>
                              </li>
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/neuron-core/query/pagination.html" class="navigation-list-link">Pagination</a>
                              </li>
                            
                          
                        </ul>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/neuron-core/transactions.html" class="navigation-list-link">Transactions</a>
                      
                    </li>
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/neuron-core/errors/" class="navigation-list-link">Errors</a>
                      
                        
                        <ul class="navigation-list-child-list">
                          
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/neuron-core/errors/error_struct.html" class="navigation-list-link">Error Struct</a>
                              </li>
                            
                          
                            
                          
                            
                          
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/neuron-core/errors/class.html" class="navigation-list-link">Class</a>
                              </li>
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                        </ul>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/neuron-core/processor.html" class="navigation-list-link">Processor</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="http://localhost:4000/neuron-gateway/" class="navigation-list-link">Gateway</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="http://localhost:4000/neuron-pq/" class="navigation-list-link">Postgres Repository</a>
            
          </li>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="http://localhost:4000/neuron-mongo/" class="navigation-list-link">Mongo Repository</a>
            
          </li>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
  </ul>
</nav>

      </div>
      <footer role="contentinfo" class="site-footer">
        <p class="text-small text-grey-dk-000 mb-0">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p>
      </footer>
    </div>
    <div class="main-content-wrap js-main-content" tabindex="0">
      <div class="page-header">
        <div class="main-content">
          
          
            <ul class="list-style-none text-small mt-md-1 mb-md-1 pb-4 pb-md-0 js-aux-nav aux-nav">
              
                <li class="d-inline-block my-0 mr-2"><a href="https://neuronlabs.github.io">Neuron Project</a></li>
              
                <li class="d-inline-block my-0 mr-2"><a href="https://neuronlabs.github.io/neuron-core">Core</a></li>
              
                <li class="d-inline-block my-0 mr-2"><a href="https://neuronlabs.github.io/neuron-gateway">Gateway</a></li>
              
                <li class="d-inline-block my-0 mr-2"><a href="https://neuronlabs.github.io/neuron-pq">PQ Repository</a></li>
              
                <li class="d-inline-block my-0"><a href="https://neuronlabs.github.io/neuron-mongo">Mongo Repository</a></li>
              
            </ul>
          
        </div>
      </div>
      <div class="main-content">
        
          
            <nav class="breadcrumb-nav">
              <ol class="breadcrumb-nav-list">
                
                  <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/neuron-core">Core ORM</a></li>
                  <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/neuron-core/query/">Query</a></li>
                
                <li class="breadcrumb-nav-list-item"><span>Scope</span></li>
              </ol>
            </nav>
          
        
        <div id="main-content" class="page-content" role="main">
          <h1 id="scope">Scope</h1>

<p>Scope is the data structure that contains all the information about given query. It keeps the information about the filtering, sorting, pagination, fieldset, selected fields, value and many other meta data. Each of it is accessible from the <code class="highlighter-rouge">*query.Scope</code> instance as the methods or variables:</p>

<ul>
  <li>ID - unique query <strong>id</strong> number (UUID)</li>
  <li>Value - Query’s value defines the values to be returned (<em>GET</em> and <em>LIST</em>), created (<em>CREATE</em>), changed (<em>PATCH</em>) or deleted (<em>DELETE</em>).</li>
  <li><a href="filters.html">Filters</a> - query filters divided by the field types
    <ul>
      <li>Primary Key filters</li>
      <li>Foreign Keys filters</li>
      <li>Attribute filters</li>
      <li>Relationship filters</li>
      <li>Filter Keys filters</li>
    </ul>
  </li>
  <li><a href="fieldset.html">Fieldset</a> - set of fields that must be returned with their values from the repository</li>
  <li><a href="selected_fields.html">Selected Fields</a> - set of fields selected to create/change any repository model</li>
  <li><a href="sorts.html">Sorting Order</a> - sorting order of the query</li>
  <li><a href="pagination.html">Pagination</a> - query paginations</li>
</ul>

<h2 id="how-to-create-a-query-scope">How to create a query Scope?</h2>

<p>A query scope can be created from the root <code class="highlighter-rouge">github.com/neuronlabs/neuron-core</code>  or the <code class="highlighter-rouge">github.com/neuronlabs/neuron-core/query</code> package.</p>

<p>In order to create a new Scope, it’s valid root model must be provided as well as the controller that keeps related models.</p>

<h3 id="create-with-value">Create with value</h3>

<p>A scope might be create with model value using <code class="highlighter-rouge">ncore.Query</code>, <code class="highlighter-rouge">ncore.QueryC</code>, <code class="highlighter-rouge">ncore.MustQuery</code> or <code class="highlighter-rouge">ncore.MustQueryC</code>. The functions with the ‘C’ ending requires the controller to be provided as the argument, whereas the other use default controller.</p>

<p>Example Must:</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">m</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="o">&amp;</span><span class="n">Model</span><span class="p">{</span><span class="n">ID</span><span class="o">:</span><span class="x"> </span><span class="m">3</span><span class="p">}</span><span class="x">

</span><span class="c">// This function creates new scope with the default controller and </span><span class="x">
</span><span class="c">// the model 'm'. It panic on error.</span><span class="x">
</span><span class="n">scope</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">ncore</span><span class="o">.</span><span class="n">MustQuery</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="x">
</span></code></pre></div></div>

<p>Example QueryC:</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">// supposed that we have already a controller 'c' with registered 'Model'.</span><span class="x">
</span><span class="n">m</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="o">&amp;</span><span class="n">Model</span><span class="p">{</span><span class="n">ID</span><span class="o">:</span><span class="x"> </span><span class="m">2</span><span class="p">,</span><span class="x"> </span><span class="n">Name</span><span class="o">:</span><span class="x"> </span><span class="s">"Anthony"</span><span class="p">}</span><span class="x">

</span><span class="c">// This takes the 'c' controller and the model 'm'.</span><span class="x">
</span><span class="c">// Returns error if the model's value is not valid.</span><span class="x">
</span><span class="n">scope</span><span class="p">,</span><span class="x"> </span><span class="n">err</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">ncore</span><span class="o">.</span><span class="n">QueryC</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="x"> </span><span class="n">m</span><span class="p">)</span><span class="x">
</span></code></pre></div></div>

<p>These queries might be also created using direct access to the <code class="highlighter-rouge">github.com/neuronlabs/neuron-core/query</code> with methods such as: <code class="highlighter-rouge">query.New</code>, <code class="highlighter-rouge">query.NewC</code>, <code class="highlighter-rouge">query.MustNew</code>, <code class="highlighter-rouge">query.MustNewC</code>. The functions with ‘C’ endings requires the <code class="highlighter-rouge">controller.Controller</code> to be provided as argument, whereas the others would use the Default Controller.</p>

<h3 id="scope-allowed-values">Scope allowed Values</h3>

<p>The scope keeps two types of values:</p>

<ul>
  <li>single instance - it is a non-nil pointer to the value model.</li>
  <li>multiple instances - a non-nil pointer to the slice of pointers to models.</li>
</ul>

<p>Examples:</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="x">
</span><span class="n">single</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">Model</span><span class="p">{</span><span class="n">ID</span><span class="o">:</span><span class="x"> </span><span class="m">5</span><span class="p">}</span><span class="x">

</span><span class="n">many</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="p">[]</span><span class="o">*</span><span class="n">Model</span><span class="p">{{</span><span class="n">ID</span><span class="o">:</span><span class="x"> </span><span class="m">3</span><span class="p">}}</span><span class="x">
</span><span class="c">// This would be correctly created scope - the value taken is an </span><span class="x">
</span><span class="c">// address of model/slice instances.</span><span class="x">
</span><span class="n">scope</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">query</span><span class="o">.</span><span class="n">MustNew</span><span class="p">(</span><span class="o">&amp;</span><span class="n">single</span><span class="p">)</span><span class="x">
</span><span class="n">scope2</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">query</span><span class="o">.</span><span class="n">MustNew</span><span class="p">(</span><span class="o">&amp;</span><span class="n">many</span><span class="p">)</span><span class="x">

</span><span class="c">// This two would panic, the value taken are not pointers to the structures.</span><span class="x">
</span><span class="n">scope</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="n">query</span><span class="o">.</span><span class="n">MustNew</span><span class="p">(</span><span class="n">single</span><span class="p">)</span><span class="x">
</span><span class="n">scope</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="n">query</span><span class="o">.</span><span class="n">MustNew</span><span class="p">(</span><span class="n">many</span><span class="p">)</span><span class="x">
</span></code></pre></div></div>

<h3 id="create-scope-with-modelstruct">Create scope with *ModelStruct</h3>

<p>The query might be also created using a <code class="highlighter-rouge">*ModelStruct</code> with the package <code class="highlighter-rouge">github.com/neuronlabs/neuron-core/query</code>. The method <code class="highlighter-rouge">query.NewModelC</code> is used to create scope with the ModelStructure. It requires controller to be provided as an argument, as well as information if the value of the query should be a slice or a single value instance <code class="highlighter-rouge">isMany</code> boolean. Created scope’s values would depend on the <code class="highlighter-rouge">isMany</code> flag, and their types would looks like:</p>

<ul>
  <li>isMany - true - <code class="highlighter-rouge">*[]*Type{}</code></li>
  <li>isMany - false - <code class="highlighter-rouge">*Type{}</code></li>
</ul>

<p>Where the <code class="highlighter-rouge">Type</code> is the model registered in the controller.</p>

<p>Example:</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">// supposed that the controller 'c' was previously </span><span class="x">
</span><span class="c">// created with registered model 'Model'.</span><span class="x">

</span><span class="n">mStruct</span><span class="p">,</span><span class="x"> </span><span class="n">_</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">c</span><span class="o">.</span><span class="n">ModelStruct</span><span class="p">(</span><span class="n">Model</span><span class="p">{})</span><span class="x">
</span><span class="n">scope</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">query</span><span class="o">.</span><span class="n">NewModelC</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="x"> </span><span class="n">mStruct</span><span class="p">,</span><span class="x"> </span><span class="no">true</span><span class="p">)</span><span class="x">

</span><span class="k">var</span><span class="x"> </span><span class="n">many</span><span class="x"> </span><span class="p">[]</span><span class="o">*</span><span class="n">Model</span><span class="x">
</span><span class="c">// scope's Value is a non-nil pointer of slice of pointer models</span><span class="x">
</span><span class="n">temp</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">scope</span><span class="o">.</span><span class="n">Value</span><span class="o">.</span><span class="p">(</span><span class="o">*</span><span class="p">[]</span><span class="o">*</span><span class="n">Model</span><span class="p">)</span><span class="x">

</span><span class="c">// dereference the pointer to get the slice of models.</span><span class="x">
</span><span class="n">many</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="o">*</span><span class="n">temp</span><span class="x">

</span></code></pre></div></div>



          
        </div>
      </div>
    </div>
  </div>

</body>
</html>
